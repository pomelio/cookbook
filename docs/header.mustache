<nav class="fixed z-30 w-full bg-white border-b border-gray-200 dark:bg-gray-800 dark:border-gray-700">
    <div class="px-3 py-3 lg:px-5 lg:pl-3">
        <div class="flex items-center justify-between">

            <!-- website basic -->
            <div class="flex items-center justify-start">

                <!-- toggle side bar in mobile -->
                <button id="toggleSidebarMobile" aria-expanded="true" aria-controls="sidebar"
                    class="p-2 text-gray-600 rounded cursor-pointer lg:hidden hover:text-gray-900 hover:bg-gray-100 focus:bg-gray-100 dark:focus:bg-gray-700 focus:ring-2 focus:ring-gray-100 dark:focus:ring-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">
                    <svg id="toggleSidebarMobileHamburger" class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20"
                        xmlns="http://www.w3.org/2000/svg">
                        <path fill-rule="evenodd"
                            d="M3 5a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 10a1 1 0 011-1h6a1 1 0 110 2H4a1 1 0 01-1-1zM3 15a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z"
                            clip-rule="evenodd"></path>
                    </svg>
                    <svg id="toggleSidebarMobileClose" class="hidden w-6 h-6" fill="currentColor" viewBox="0 0 20 20"
                        xmlns="http://www.w3.org/2000/svg">
                        <path fill-rule="evenodd"
                            d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z"
                            clip-rule="evenodd"></path>
                    </svg>
                </button>

                <!-- website logo and title -->
                <a href="https://cookbook.au.pagwe.net/" class="flex ml-2 md:mr-24">
                    <img src="https://cookbook.au.pagwe.net/public/images/pagwe-logo.png" class="h-8 mr-3"
                        alt="Pagwe Logo" />
                    <span
                        class="self-center text-xl font-semibold sm:text-2xl whitespace-nowrap dark:text-white">Pagwe</span>
                </a>

            </div>

            <!-- website navi links -->
            <div class="flex items-center">

                <!-- theme selection placeholder -->
                <div id='theme-toggle'></div>

                <!-- user-panel placeholder -->
                <div id="user-panel"></div>

            </div>
        </div>
    </div>
</nav>

<script>

    const myAccount = localStorage.getItem('my-account');

    const loginPanel = document.getElementById('login-panel');
    const userPanel = document.getElementById('user-panel');

    if (!myAccount) {
        userPanel.classList.add('hidden');
        loginPanel.classList.remove('hidden');
    } else {
        userPanel.classList.remove('hidden');
        loginPanel.classList.add('hidden');
    }

    function onGoogleLogin() {
        axios({
            method:'get',
            url: '/google/auth_url',
            responseType: 'json',
        }.then(result => {
            var popup = popup_window('google-oauth-authorize',
            result.url,
            { height: 1000, width: 600 });
            popup.then(params => {
                axios({
                    method: 'get',
                    url: '/google/callback',
                    responseType: 'json',
                }).then(user => {
                    onLoginSuccess(user);
                })
            })
        });
    }

    function onGithubLogin() {
        axios({
            method:'get',
            url: '/github/auth_url',
            responseType: 'json',
        }.then(result => {
            var popup = popup_window('github-oauth-authorize',
            result.url,
            { height: 1000, width: 600 });
            popup.then(params => {
                axios({
                    method: 'get',
                    url: '/github/callback',
                    responseType: 'json',
                }).then(user => {
                    onLoginSuccess(user);
                })
            });
        });
    }

    function onLoginSuccess(user) {
        console.log(user);
    }


    if (localStorage.getItem('color-theme') === 'dark' || (!('color-theme' in localStorage) && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
        document.documentElement.classList.add('dark');
    } else {
        document.documentElement.classList.remove('dark');
    }


    //theme
    const themeToggleDarkIcon = document.getElementById('theme-toggle-dark-icon');
    const themeToggleLightIcon = document.getElementById('theme-toggle-light-icon');

    // Change the icons inside the button based on previous settings
    if (localStorage.getItem('color-theme') === 'dark' || (!('color-theme' in localStorage) && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
        themeToggleLightIcon.classList.remove('hidden');
    } else {
        themeToggleDarkIcon.classList.remove('hidden');
    }

    const themeToggleBtn = document.getElementById('theme-toggle');

    let event = new Event('dark-mode');

    themeToggleBtn.addEventListener('click', function () {

        // toggle icons
        themeToggleDarkIcon.classList.toggle('hidden');
        themeToggleLightIcon.classList.toggle('hidden');

        // if set via local storage previously
        if (localStorage.getItem('color-theme')) {
            if (localStorage.getItem('color-theme') === 'light') {
                document.documentElement.classList.add('dark');
                localStorage.setItem('color-theme', 'dark');
            } else {
                document.documentElement.classList.remove('dark');
                localStorage.setItem('color-theme', 'light');
            }

            // if NOT set via local storage previously
        } else {
            if (document.documentElement.classList.contains('dark')) {
                document.documentElement.classList.remove('dark');
                localStorage.setItem('color-theme', 'light');
            } else {
                document.documentElement.classList.add('dark');
                localStorage.setItem('color-theme', 'dark');
            }
        }

        document.dispatchEvent(event);

    });

</script>